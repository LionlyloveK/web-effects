<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>150.SVG拟物态圆环进度条</title>
  </head>
  <style>
    :root {
      --primary-light: #c1dfc4;
      --primary-dark: #3cba92;
      --white: #ffffff;
      --greyLight-1: #ebf5fc;
      --greyLight-2: #d5e0f3;
      --greyDark: #646b8c;
    }

    *,
    *::before,
    *::after {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    html {
      box-sizing: border-box;
      font-size: 62.5%;
      overflow-y: scroll;
      -webkit-font-smoothing: antialiased;
      letter-spacing: 0.5px;
      line-height: 1.4;
    }

    .container {
      min-height: 100vh;
      display: flex;
      justify-content: center;
      align-items: center;
      background: var(--greyLight-2);
      padding: 2rem;
    }

    .card {
      width: 34rem;
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      border-radius: 2rem;
      background: var(--greyLight-1);
      box-shadow: 0px 20px 30px rgba(100, 131, 177, 0.2);
      padding: 5rem;
      border: 1px solid white;
    }
    .card__percent {
      position: relative;
      display: flex;
      justify-content: center;
      align-items: center;
    }
    .card__number {
      position: absolute;
      color: var(--greyDark);
      font-size: 3.6rem;
      font-family: "DM Sans", sans-serif;
    }

    svg {
      position: relative;
      width: 24rem;
      height: 24rem;
      z-index: 1000;
      transform: rotate(-90deg);
    }

    svg circle {
      width: 100%;
      height: 100%;
      fill: none;
      stroke-linecap: round;
      transform: translate(3rem, 3rem);
      stroke-dasharray: 565.49;
      stroke-dashoffset: 565.49;
      /* 282.75对应50% */
      /* transition: all 1s ease; */
      stroke-width: 24;
    }

    .circle {
      position: absolute;
      width: 23rem;
      height: 23rem;
      border-radius: 50%;
      box-shadow: 6px 6px 8px var(--greyLight-2), -6px -6px 8px var(--white);
      background: var(--greyLight-1);
    }
    .circle__medium {
      width: 20.5rem;
      height: 20.5rem;
      box-shadow: inset 8px 8px 10px var(--greyLight-2),
        inset -4px -4px 8px var(--white);
    }
    .circle__small {
      width: 15.5rem;
      height: 15.5rem;
      box-shadow: 6px 6px 8px var(--greyLight-2), -2px -2px 8px var(--white);
    }
  </style>
  <body>
    <div class="container">
      <div class="card">
        <div class="card__percent">
          <svg>
            <defs>
              <radialGradient
                id="gradient"
                cx="50%"
                cy="50%"
                r="60%"
                fx="50%"
                fy="50%"
              >
                <stop offset="30%" stop-color="var(--primary-dark)" />
                <stop offset="100%" stop-color="var(--primary-light)" />
              </radialGradient>
            </defs>
            <circle
              cx="90"
              cy="90"
              r="90"
              stroke="url(#gradient)"
              id="circle"
            ></circle>
          </svg>
          <div class="circle"></div>
          <div class="circle circle__medium"></div>
          <div class="circle circle__small"></div>
          <div class="card__number">--</div>
        </div>
      </div>
    </div>
  </body>
  <script>
    const getData = () => {
      const circle = document.getElementById("circle");
      const number = document.querySelector(".card__number");

      function circlePercent(e) {
        let change = 565.49 - (565.49 * e) / 100;
        circle.style.strokeDashoffset = change;
      }
      let i = 0;
      let timer = null;
      const loading = () => {
        if (i < 100) {
          i++;
          number.innerHTML = i + "%";
          circlePercent(i);
        } else {
          i = 0;
          clearInterval(timer);
          setTimeout(() => {
            circlePercent(565.49);
            number.innerHTML = "0%";
            timer = setInterval(loading, 100);
          }, 2000);
        }
      };
      loading();
      timer = setInterval(loading, 100);
    };
    getData();
  </script>
</html>
