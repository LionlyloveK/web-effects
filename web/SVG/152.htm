<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Document</title>
  </head>
  <script src="https://cdn.jsdelivr.net/npm/vue@2"></script>
  <link rel="stylesheet" href="../common.css" />
  <style>
    .container {
      width: 300px;
      height: 400px;
      transform: rotateX(53deg);
    }

    .container circle {
      transform-origin: center;
      transform: rotate(-90deg);
      fill: none;
    }

    .container text {
      font-family: "Bahnschrift";
      text-anchor: middle;
      fill: white;
    }

    .container text tspan {
      font-size: 20px;
    }
  </style>

  <body>
    <div id="app">
      <div class="container">
        <svg viewBox="0 0 100 100">
          <mask id="dailyMask">
            <!-- 用一个蒙版mask -->
            <circle
              cx="50"
              cy="50"
              r="35"
              :stroke-dasharray="getDash(35)"
              stroke-width="12"
              stroke="white"
            ></circle>
          </mask>
          <!-- 设置底部最大的圆环 -->
          <circle
            cx="50"
            cy="50"
            r="35"
            stroke-width="12"
            stroke="#444A"
          ></circle>
          <!-- 设置进度条的颜色、长度等，覆盖蒙版 -->
          <circle
            cx="50"
            cy="50"
            r="35"
            :stroke-dasharray="getCircleDash(curr, total, 35)"
            stroke-width="12"
            stroke="orange"
            mask="url(#dailyMask)"
          ></circle>
          <!-- 文字 -->
          <text x="50%" y="60%">
            {{getPercent(curr, total)}}
            <tspan>%</tspan>
          </text>
        </svg>
      </div>
    </div>
  </body>
  <script>
    new Vue({
      el: "#app",
      data() {
        return {
          total: 200,
          curr: 50,
        };
      },
      methods: {
        getPercent(e1, e2) {
          return ((100 * e1) / e2).toFixed(0);
        },
        getCircleDash(e1, e2, r) {
          let girth = 2 * Math.PI * r;
          return (e1 / e2) * girth + " " + girth;
        },
        getDash(r) {
          return r * 0.3 + " " + r * 0.1;
        },
      },
    });
  </script>
</html>
